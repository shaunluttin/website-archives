
<!DOCTYPE html> 
<html lang="en-US" class="static detail-blog-post dir-ltr contents" dir="ltr"> 

<!-- Mirrored from www.muddlingthru.ca/draft-inheritance-related-keywords-in-c by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 09 Dec 2022 06:17:10 GMT -->
<head> 
    <meta charset="utf-8" />
    <title>Muddling Thru - Inheritance, Interfaces, and the Abstract, Virtual, and Sealed Keywords in C#</title> 
    <link href="http://fonts.googleapis.com/css?family=Lobster&amp;subset=latin" rel="stylesheet" type="text/css" />
<link href="Themes/Bootstrap_3_3_4_Base/Styles/base.css" rel="stylesheet" type="text/css" />
<link href="Themes/Bootstrap_3_3_4_SimpleBlog/Styles/theme.css" rel="stylesheet" type="text/css" />
<!--[if lt IE 9]>
<script src="/Core/Shapes/scripts/html5.js" type="text/javascript"></script>
<![endif]-->
<meta content="Orchard" name="generator" />
<meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible" />
<link href="modules/orchard.themes/Content/orchard.ico" rel="shortcut icon" type="image/x-icon" />

<link rel="alternate" type="application/rss+xml" title="Muddling Thru" href="rss91cc?containerid=12" />

    <script>(function(d){d.className="dyn"+d.className.substring(6,d.className.length);})(document.documentElement);</script> 
    <script>window.isRTL = false;</script>
</head> 
<body>


<div class="aside-1" id="layout-wrapper">
<header id="layout-header" class="group">
    <div id="header">
        <div class="zone zone-header"><h1 id="branding"><a href="index.html">Muddling Thru</a></h1>
</div>
    </div>
</header>
<div id="layout-navigation" class="group">
    <div class="zone zone-navigation">
<article class="widget-navigation widget-menu-widget widget">
    
<nav>
    <ul class="menu menu-main-menu">
        
        
    </ul>
</nav>
</article>
<article class="widget-navigation widget-html-widget widget">
    <p>Welcome to&nbsp;<a href="http://www.shaunluttin.com/">Shaun Luttin's</a> public notebook. It contains rough, practical notes. The guiding idea is that, despite what marketing tells us, there are no experts at anything. Sharing our half-baked ideas helps everyone. <strong>We're all just muddling thru</strong>. Find out more about our work at <a href="http://www.bigfont.ca/">bigfont.ca.</a></p>
</article></div>
</div>
<div id="layout-main-container">
<div id="layout-main" class="group">
    <aside id="aside-first" class="aside-first group">
        <div class="zone zone-aside-first">
<article class="widget-aside-first widget-search-form widget">
    
<form action="DISABLED_SEARCH_FORM_ACTION" class="search-form form form-inline" method="get">    <fieldset disabled>
        <input class="form-control input-lg" id="q" name="q" placeholder="Search" type="text" value="" />
        <button class="btn btn-default btn-lg" type="submit">Search!</button>
    </fieldset>
</form>
</article>
<article class="widget-aside-first widget-html-widget widget">
    <p><img class="img-thumbnail" alt="" src="Media/Default/Website-UI-Uploads/business_happy_200x200.jpg" height="200" width="200" /></p>
</article></div>
    </aside>
    <div id="layout-content" class="group">
                        <div id="content" class="group">
            <div class="zone zone-content">
<article class="blog-post content-item">
    <header>
        

<h1>Inheritance, Interfaces, and the Abstract, Virtual, and Sealed Keywords in C#</h1>

    <p class="tags">
        <span>Tags:</span>
<a href="Tags/C%23-2.html">C#</a>, <a href="Tags/keywords.html">keywords</a>    </p>

            <div class="metadata">
                <div class="published">Tuesday, February 24, 2015 4:50:42 PM</div>
            </div>
    </header>
    <p><h1>Introduction</h1> <p>This is meant to be an incomplete overview of inheritance related keywords in C#. There are more details in the MSDN documentation.</p> <ul> <li>abstract: <a title="https://msdn.microsoft.com/en-us/library/sf985hc5.aspx" href="https://msdn.microsoft.com/en-us/library/sf985hc5.aspx">https://msdn.microsoft.com/en-us/library/sf985hc5.aspx</a> </li> <li>virtual: <a title="https://msdn.microsoft.com/EN-US/library/9fkccyh4%28v=VS.120,d=hv.2%29.aspx" href="https://msdn.microsoft.com/EN-US/library/9fkccyh4(v=VS.120,d=hv.2).aspx">https://msdn.microsoft.com/EN-US/library/9fkccyh4%28v=VS.120,d=hv.2%29.aspx</a> </li> <li>sealed: <a title="https://msdn.microsoft.com/en-us/library/88c54tsw.aspx" href="https://msdn.microsoft.com/en-us/library/88c54tsw.aspx">https://msdn.microsoft.com/en-us/library/88c54tsw.aspx</a> </li> <li>interface: <a title="https://msdn.microsoft.com/EN-US/library/87d83y5b%28v=VS.120,d=hv.2%29.aspx" href="https://msdn.microsoft.com/EN-US/library/87d83y5b(v=VS.120,d=hv.2).aspx">https://msdn.microsoft.com/EN-US/library/87d83y5b%28v=VS.120,d=hv.2%29.aspx</a> </li> <li>abstract and sealed: <a title="https://msdn.microsoft.com/EN-US/library/ms173150%28v=VS.120,d=hv.2%29.aspx" href="https://msdn.microsoft.com/EN-US/library/ms173150(v=VS.120,d=hv.2).aspx">https://msdn.microsoft.com/EN-US/library/ms173150%28v=VS.120,d=hv.2%29.aspx</a> </li></ul> <h1>Remaining Questions to Answer</h1> <p>This post is a work in progress. I would still like to document answers to the following questions.</p> <ul> <li>Are an interface's methods implicitly virtual (in the same way that abstract methods are implicitly virtual?) </li> <li>If not, can an interface's methods contain the virtual keyword?</li> <li>Is there any point in sealing a method that wasn't previously virtual?</li> <li>What is an indexer?</li></ul> <h1>Use Cases of Interface, Abstract, Virtual and Sealed</h1> <p>Inheritance is about sharing the inputs and outputs (the what) and/or the transformation and side-effects (how) among classes and interfaces. A method's signature defines the what and its body defines the how. </p> <h2>Containers</h2> <h3>Interface</h3> <p><strong>Provide what; require how. </strong>Use an interface 1. to provide inputs and outputs that a derived class must process and 2. to require that the derived class define how to process those. <u>Analogy</u>: a recipe book template that provides dish names, ingredients, and resultant meals but no recipe steps.</p> <h3>Abstract Class</h3> <p><strong>Provides what; require, suggest, or provide how. </strong>An abstract class is versatile: 1. use it with abstract members to provide the what and require the how; 2. use it with virtual members to provide the what and suggest the how, or 3. use it with normal members to provide both the what and the how. You can take all three approaches in the same class. <u>Analogy</u>: The same cookbook template as above but also with penned in and/or penciled in recipe steps.</p> <h3>Normal Class</h3> <p><strong>Provide what; suggest or provide how</strong>. 1. Use it with virtual members to suggest processing, 2 use it with normal members to provide processing. You can can both approaches in the same class. Abstract members though are forbidden.</p> <h3>Sealed Class</h3> <p><strong>Prevent further derivations; end the inheritance line</strong>. Use it to prevent further derived classes. In other words, end this branch of the inheritance tree.</p> <h2>Members</h2> <h3>Abstract Member</h3> <p><strong>Provide what; require how. </strong>Use an abstract member, within an abstract class, to provide inputs and outputs that a derived class must process.</p> <h3>Virtual Member</h3> <p><strong>Provide what; suggest how. </strong>Use a virtual member to provide the what and suggest the how. Any descendant class can override the how. <u>Analogy</u>:&nbsp; a suggested, default way to make toast out of bread and a toaster. </p> <h3>Normal Member</h3> <p><strong>Provide both what and how. </strong>Use a normal, non-virtual member to provide both the what and how that a derived class cannot override. <u>Analogy</u>: a mandatory set of steps for how to make cereal. </p> <h3>Sealed Member</h3> <p><strong>Override how; prevent further overriding. </strong>Use a member to prevent further derived classes from changing how this member works. <u>Analogy</u>: a mandatory set of steps for what used to be a suggested way to make toast.</p> <h1>Continuum of Member Implementation Freedom</h1> <p>Minimal Freedom --&gt; Most Freedom --&gt; Minimal Freedom. A derived class... </p> <ul> <li>... <strong>must </strong>implement all members of an interface, </li> <li>... must implement (override) all abstract members, </li> <li>... may implement (override) any virtual members, </li> <li>... may no longer implement (override) sealed members, and </li> <li>... may not implement (override) <u>normal</u> members. </li></ul> <p>Sealed is only appropriate for a member that is virtual somewhere up the inheritance chain. Once a member is virtual, that member stays virtual until sealed. Sealed says that no further descendant classes can override this.</p> <h1>Interface Versus Abstract Class</h1> <h2>Similarities</h2> <ul> <li>Both interfaces and abstract classes may contain method signatures that lack implementation details.</li></ul> <h2>Differences</h2> <ul> <li>a derived class can implement multiple interfaces whereas a derived class can implement only one abstract class </li> <li>a derived class must implement all of an interfaces methods whereas a derived class must implement only the abstract members of an abstract class </li> <li>an interface cannot have any implementation details <strong>whereas</strong> an abstract class can contain implementation details </li></ul> <h1>Abstract Versus Virtual</h1> <h2>Similarities </h2> <p>Both the abstract and virtual keywords...</p> <ul> <li>... are appropriate for methods, properties, indexers, and events  <li>... allow a derived class to override the member with the override modifier </li></ul> <ul> <li>... let each subsequent descendant re-override the previous descendants override (until a member is sealed) </li></ul> <h2>Differences</h2> <ul> <li>abstract can apply to a class <strong>whereas</strong> virtual cannot apply to a class  <li>derived classes <em>must</em> override abstract members <strong>whereas</strong> derived classes <em>may</em> override virtual members  <li>abstract members are allowed only in an abstract class<strong>&nbsp; whereas </strong>virtual members are allowed in any class </li></ul> <ul> <li>abstract members are virtual <strong>whereas </strong>virtual members are not abstract </li></ul> <h2>When applied to a class, abstract means...</h2> <ul> <li>the class is meant only as a base class  <li>we cannot <em>directly</em> instantiate the abstract class  <li>the class may contain normal, virtual, and/or abstract members  <li>the class cannot be sealed (i.e. the class cannot forbid inheritance) </li></ul> <h1>Sealed</h1> <ul> <li>when applied to a class, sealed prevents inheritance of the entire class  <li>when applied to a method, property, index, or event, sealed prevents a derived class from overriding the member </li></ul> <ul> <li>sealed members are useful to prevent further overriding of an ancestral virtual member </li></ul> <h1>Illustrative Code Example</h1><pre>
public interface IBook
{
    object TableOfContents { get; }
    object Index { get; }
    object Cover { get; }
}</p>

<p>public interface IBreakfastRecipeBook
{
    object MakeOmlette(object egg, object cheese, object fryingPan);
    object MakeToast(object bread, object toaster);
    object MakeTea(object teaBag, object pot, object kettle, object water);
}</p>

<p>public abstract class EnglishBreakfastRecipeBook : IBreakfastRecipeBook, IBook
{
    // from IBreakfastRecipeBook
    public abstract object MakeToast(object bread, object toaster);
    public abstract object MakeOmlette(object egg, object cheese, object fryingPan);
    public object MakeTea(object teaBag, object pot, object kettle, object water)
    {
        return new { };
    }</p>

<pre><code>// from IBook
public object TableOfContents { get { return new { }; } }
public object Index { get { return new { }; } }
public object Cover { get { return new { }; } }

// new member
public virtual object MakeCereal(object cereal, object milk, object bowl)
{
    return new { };
}       
</code></pre>

<p>}</p>

<p>public class ExampleEnglishRecipeBook : EnglishBreakfastRecipeBook
{
    public override object MakeToast(object bread, object toaster)
    {
        return new { };
    }</p>

<pre><code>public override object MakeOmlette(object egg, object cheese, object fryingPan)
{
    return new { };
}

public override sealed object MakeCereal(object cereal, object milk, object bowl)
{
    return new { };
}
</code></pre>

<p>}</p>

<p>public class EnglishRecipeBookVersion1 : ExampleEnglishRecipeBook
{
    public override object MakeToast(object bread, object toaster)
    {
        return new { };
    }</p>

<pre><code>//public override object MakeCereal(object cereal, object milk, object bowl)
//{
//    return new { };
//}
</code></pre>

<p>}</p>

<p></pre></p>

</article></div>
        </div>
            </div>
</div>
</div>
<div id="layout-footer" class="group">
    <footer id="footer">
        <div id="footer-quad" class="group">
                                            </div>
        <div id="footer-sig" class="group">
            <div class="zone zone-footer"><div class="credits">
    <span class="poweredby">Powered by <a href="http://www.orchardproject.net/" target="_blank">Orchard</a></span>
    <span class="copyright">&#169; Bootstrap 3.3.4 Simple Blog 2015.</span>
</div>
<div class="user-display">
        <span class="user-actions"><a href="Users/Account/LogOnde2c.html?ReturnUrl=%2Fdraft-inheritance-related-keywords-in-c" rel="nofollow">Sign In</a></span>
</div></div>
        </div>
    </footer>
</div>
</div>
<script src="Themes/Bootstrap_3_3_4_Base/scripts/base.js" type="text/javascript"></script>
<script src="Themes/Bootstrap_3_3_4_Base/scripts/theme.js" type="text/javascript"></script>

</body>

<!-- Mirrored from www.muddlingthru.ca/draft-inheritance-related-keywords-in-c by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 09 Dec 2022 06:17:10 GMT -->
</html>